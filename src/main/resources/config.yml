# ========================================
# SimpleVoiceMechanics Configuration
# ========================================
#
# This plugin integrates SimpleVoiceChat with Minecraft mechanics.
# Mobs can hear players speaking and Sculk Sensors detect voice.
#

# ----------------------------------------
# Global Detection Settings
# ----------------------------------------
# Default settings that apply to all entities unless overridden

detection:
  # Maximum range for voice detection (in blocks)
  # Everything outside this range hears nothing
  max-range: 16.0

  # Minimum range for guaranteed detection (in blocks)
  # Within this range: 100% detection chance
  min-range: 2.0

  # How smooth is the transition between min and max? (0.0 - 2.0)
  # 0.5 = linear falloff
  # 1.0 = moderate falloff (recommended)
  # 1.5 = strong falloff (barely noticeable until far out)
  # 2.0 = very strong falloff (almost full volume everywhere)
  falloff-curve: 1.0

# ----------------------------------------
# Environmental Modifiers
# ----------------------------------------
# Realistic sound propagation based on biome and time

environmental-modifiers:
  # Biome-based sound modifiers
  biome-modifiers:
    enabled: true
    # How biomes affect sound:
    # CAVE/UNDERGROUND: 1.5x range, -5 dB (Echo amplification)
    # FOREST/TAIGA: 0.75x range, +3 dB (Vegetation dampening)
    # JUNGLE/BAMBOO: 0.65x range, +3 dB (Dense vegetation)
    # OCEAN/RIVER/BEACH: 0.6x range (Water muffling)
    # MOUNTAIN/HILLS/PEAKS: 1.2x range (Sound carries well)
    # DESERT/BADLANDS: 1.1x range (Clear dry air)
    # PLAINS: 1.0x range (Normal)
    # NETHER: 1.3x range (Nether acoustics)
    # END: 0.9x range (Void dampens)

  # Time-of-day modifiers
  time-modifiers:
    enabled: true
    # How time affects sound:
    # DAY: 1.0x range, +0 dB (Normal)
    # DUSK: 1.15x range, -4 dB (Slightly more sensitive)
    # NIGHT: 1.3x range, -8 dB (Mobs very alert)
    # DAWN: 1.15x range, -4 dB (Slightly more sensitive)

# ----------------------------------------
# Mob Hearing Mechanics
# ----------------------------------------
mob-hearing:
  enabled: true

  # ---- Hostile Mobs (Attack on detection) ----
  hostile-mobs:
    enabled: true
    # Volume threshold in decibels (dB)
    # Only audio above this level will be detected by hostile mobs
    # Range: -127 (silence) to 0 (maximum)
    # Recommended: -40 (normal speaking)
    volume-threshold-db: -40.0
    # Optional: Override for this category
    max-range: null  # null = uses detection.max-range
    min-range: null  # null = uses detection.min-range
    falloff-curve: null  # null = uses detection.falloff-curve
    # Blacklist: These mobs will NOT hear
    blacklist:
      - "PHANTOM"
      - "VEX"

    # When one mob detects voice, it alerts nearby mobs of same type
    group-alert:
      enabled: true
      max-alerts: 5  # Maximum mobs to alert per detection
      # Mob-specific alert ranges (optional overrides)
      # Closer detections = more mobs alerted (1-5 dynamically)
      ranges:
        zombie: 16.0          # Zombies form hordes
        husk: 16.0
        drowned: 12.0
        zombie_villager: 16.0
        skeleton: 12.0        # Skeleton groups
        stray: 12.0
        spider: 10.0          # Spider swarms
        cave_spider: 10.0
        wolf: 20.0            # Pack hunters
        piglin: 18.0          # Piglin groups (very social)
        zombified_piglin: 20.0  # Angry piglin groups
        bee: 8.0              # Bee swarms
        pillager: 24.0        # Pillager patrols
        vindicator: 18.0
        evoker: 18.0

  # ---- Neutral Mobs (Normally peaceful) ----
  neutral-mobs:
    enabled: true
    look-at-player: true  # Look at the player
    # Volume threshold for neutral mobs
    # Recommended: -35 (slightly more sensitive than hostile)
    volume-threshold-db: -35.0
    max-range: null
    min-range: null
    falloff-curve: null
    # Natural behavior settings
    natural-behavior:
      # Not all mobs react every time (more realistic)
      # Chance that a mob will react to voice (0.0 - 1.0)
      reaction-chance: 0.6  # 60% chance to react
      # How long mob looks at player after reacting (seconds)
      look-duration: 8  # 8 seconds
      # Cooldown between reactions (seconds)
      reaction-cooldown: 3  # 3 seconds
    blacklist:
      - "ENDERMAN"

  # ---- Passive/Peaceful Mobs (Never aggressive) ----
  peaceful-mobs:
    enabled: true
    look-at-player: true
    # Volume threshold for peaceful mobs
    # Recommended: -30 (more sensitive, easily scared)
    volume-threshold-db: -30.0
    max-range: 8.0  # Shorter range for peaceful mobs
    min-range: 1.5
    falloff-curve: 1.2
    # Natural behavior settings
    natural-behavior:
      # Not all mobs react every time (more realistic)
      # Chance that a mob will react to voice (0.0 - 1.0)
      reaction-chance: 0.7  # 70% chance to react
      # How long mob looks at player after reacting (seconds)
      look-duration: 10  # 10 seconds
      # Cooldown between reactions (seconds)
      reaction-cooldown: 3  # 3 seconds
    # Flee when frightened by loud noise
    flee-behavior:
      enabled: true
      # Volume threshold for fleeing (louder than normal)
      # Recommended: -20 (loud speaking/shouting)
      flee-volume-db: -20.0
      # Maximum distance to flee from player (blocks)
      flee-distance: 3.0
      # Duration of flee behavior (seconds)
      flee-duration: 3  # 3 seconds
    # Sneaking + Talking = Mobs follow
    follow-when-sneaking:
      enabled: true
      # Must look at mob first before it follows
      require-eye-contact: true
      # Eye contact detection range (blocks)
      eye-contact-range: 4.0
      # How long mob remembers eye contact (seconds)
      eye-contact-memory: 5  # 5 seconds
      # How long mob follows (seconds)
      duration: 60  # 60 seconds
      # Max follow distance (blocks)
      max-distance: 12.0
    blacklist: []

  # ---- Warden (Special behavior) ----
  warden:
    enabled: true
    # Volume threshold for Warden
    # Recommended: -20 (loud speaking) or -50 (very sensitive)
    volume-threshold-db: -20.0
    max-range: 24.0  # Warden hears further
    min-range: 3.0
    falloff-curve: 0.8  # Warden hears well even far away
    # Anger scales with distance and volume:
    # Close + Loud: 50-60 Anger
    # Medium + Normal: 30-50 Anger
    # Far + Quiet: 15-30 Anger

# ----------------------------------------
# Sculk Sensor Detection
# ----------------------------------------
sculk-hearing:
  enabled: true
  # Volume threshold for Sculk Sensors
  # Recommended: -20 (loud speaking, like vanilla)
  volume-threshold-db: -20.0
  max-range: 16.0  # Standard Sculk Sensor Range
  min-range: 2.0
  falloff-curve: 0.9  # Sculk Sensors are more sensitive
  # Cooldown between activations (ms)
  cooldown: 1000

# ----------------------------------------
# Debug Options
# ----------------------------------------
debug:
  # Shows audio level calculations (dB, normalized, category)
  audio-logging: false
  # Shows range calculations
  range-logging: false
  # Shows mob reactions
  detection-logging: false
  # Shows Warden anger
  warden-logging: false
  # Shows Sculk activations
  sculk-logging: false
  # Shows Peaceful Mob reactions
  peaceful-logging: false
  # Shows environmental modifiers
  environmental-logging: false
  # Shows mob group alerts
  group-alert-logging: false

# ----------------------------------------
# Explanation: Environmental Modifiers
# ----------------------------------------
#
# ENVIRONMENTAL MODIFIERS create realistic sound propagation:
#
# Example 1: Cave at Night
# - Biome: Cave (1.5x range, -5 dB threshold)
# - Time: Night (1.3x range, -8 dB threshold)
# - Combined: ~2.0x range, -13 dB more sensitive
# - Result: Mobs hear whispers from FAR away. VERY DANGEROUS!
#
# Example 2: Forest during Day
# - Biome: Forest (0.75x range, +3 dB threshold)
# - Time: Day (1.0x range, +0 dB threshold)
# - Combined: 0.75x range, +3 dB less sensitive
# - Result: Vegetation dampens sound. Safer for stealth.
#
# Example 3: Nether Fortress
# - Biome: Nether (1.3x range)
# - Result: Sound carries well in Nether. Be careful!
#
# Example 4: Mountain Peak at Night
# - Biome: Mountain (1.2x range)
# - Time: Night (1.3x range, -8 dB)
# - Combined: 1.56x range, -8 dB more sensitive
# - Result: Sound echoes across peaks at night.
#
# STRATEGIC GAMEPLAY:
# - Caves at night = EXTREME DANGER (2x detection range)
# - Forests during day = SAFER (0.75x detection range)
# - Plan your route based on biome and time
# - Sneak through forests, avoid caves and open spaces
#
# MOB GROUP ALERTS:
# When hostile mob detects player:
# - Zombie hears player → calls 5 nearby zombies (16 blocks)
# - Wolf hears player → alerts pack (20 blocks)
# - Piglin hears player → summons group (18 blocks)
# - Creates coordinated attacks and challenging encounters
# - Closer detections = more mobs alerted (1-5 dynamically)

# ----------------------------------------
# Explanation: Hybrid Detection System
# ----------------------------------------
#
# HOW IT WORKS:
# 1. Player speaks → Voice Packet is captured
# 2. Opus audio is decoded to PCM samples
# 3. Audio level is calculated in decibels (dB)
# 4. NEW v1.3: Environmental modifiers are applied (biome + time)
# 5. If dB > adjusted threshold → Event is fired
# 6. Entities within modified range check detection probability
# 7. Detection chance based on distance and falloff-curve
# 8. NEW v1.3: If hostile mob detected, alert nearby allies
#
# DECIBEL (dB) SCALE:
# -127 dB: Complete silence
# -100 dB: Extremely quiet (background noise)
# -60 dB: Quiet speaking/whisper
# -40 dB: Normal speaking (default threshold)
# -20 dB: Loud speaking
# 0 dB: Maximum volume (shouting)
#
# VOLUME THRESHOLD EXAMPLES:
# volume-threshold-db: -60
#   → Very sensitive, detects whispers
#   → Good for stealth servers
#
# volume-threshold-db: -40 (default)
#   → Balanced, normal speaking required
#   → Recommended for most servers
#
# volume-threshold-db: -20
#   → Less sensitive, only loud speaking
#   → Good for action-focused servers
#
# RANGE SYSTEM:
# After volume check, distance-based detection:
# - 0-2 blocks (min-range): 100% detection chance
# - 2-16 blocks: Smooth falloff based on falloff-curve
# - 16+ blocks (max-range): 0% detection chance
#
# EXAMPLE (default settings in cave at night):
# Player speaks at -35 dB (normal volume):
# - Environment: Cave (1.5x) × Night (1.3x) = 1.95x modifier
# - Threshold: -40 dB → -53 dB (much easier to detect!)
# - Passes threshold (-35 > -53) ✓
# - Range: 16 blocks → 31 blocks (modified!)
# - At 8 blocks: ~95% chance (instead of 60%)
# - At 16 blocks: ~70% chance (instead of 10%)
# - At 24 blocks: ~40% chance (instead of 0%)
# - Detected zombie alerts 5 nearby zombies → 6 zombies attack!
#
# Player whispers at -50 dB in forest:
# - Environment: Forest (0.75x) dampens sound
# - Threshold: -40 dB → -37 dB (harder to detect)
# - Range: 16 blocks → 12 blocks
# - Fails threshold (-50 < -37) ✗
# - No detection

# ----------------------------------------
# Tuning Guide
# ----------------------------------------
#
# For STEALTH gameplay (hard to detect):
# - Increase min-range (e.g., 4.0)
# - Decrease max-range (e.g., 12.0)
# - Lower falloff-curve (e.g., 0.7)
# - Enable environmental modifiers (adds strategy)
#
# For ACTION gameplay (easy to detect):
# - Decrease min-range (e.g., 1.0)
# - Increase max-range (e.g., 20.0)
# - Higher falloff-curve (e.g., 1.5)
# - Disable environmental modifiers for consistency
# - Increase group-alert.max-alerts for bigger fights
#
# For REALISTIC gameplay (balanced):
# - Keep defaults
# - Enable all environmental modifiers
# - Adjust per mob category as needed
#
# For HARDCORE gameplay:
# - Enable all environmental modifiers
# - Lower volume thresholds (e.g., -50 dB)
# - Increase max-range (e.g., 24.0)
# - Increase group-alert.max-alerts (e.g., 10)
#
# EXAMPLES:
#
# Ultra-realistic survival:
#   environmental-modifiers.biome-modifiers.enabled: true
#   environmental-modifiers.time-modifiers.enabled: true
#   hostile-mobs.volume-threshold-db: -45.0
#   hostile-mobs.max-range: 18.0
#   hostile-mobs.group-alert.enabled: true
#
# Hardcore cave exploration:
#   biome-modifiers.enabled: true
#   time-modifiers.enabled: true
#   warden.volume-threshold-db: -60.0
#   warden.max-range: 32.0
#   group-alert.max-alerts: 10
#
# Casual gameplay:
#   environmental-modifiers.biome-modifiers.enabled: false
#   environmental-modifiers.time-modifiers.enabled: false
#   group-alert.enabled: false
#   All default ranges
#
# Peaceful server (animals only):
#   hostile-mobs.enabled: false
#   neutral-mobs.enabled: true
#   peaceful-mobs.enabled: true
#   environmental-modifiers.enabled: false

# ----------------------------------------
# Performance Notes
# ----------------------------------------
#
# Environmental modifiers add minimal overhead:
# - Biome check: ~0.1ms per voice event
# - Time check: ~0.01ms per voice event
# - Group alert: Only on successful detection, max 5 mobs
# - No measurable TPS impact on servers with <100 players
#
# For maximum performance on large servers (100+ players):
# - Set group-alert.max-alerts to 3
# - Disable environmental-logging
# - Keep biome/time modifiers enabled (very cheap)