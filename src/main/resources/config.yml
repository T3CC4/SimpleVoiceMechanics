# ========================================
# SimpleVoiceMechanics Configuration
# ========================================
#
# This plugin integrates SimpleVoiceChat with Minecraft mechanics.
# Mobs can hear players speaking and Sculk Sensors detect voice.
#

# ----------------------------------------
# Global Detection Settings
# ----------------------------------------
# Default settings that apply to all entities unless overridden

detection:
  # Maximum range for voice detection (in blocks)
  # Everything outside this range hears nothing
  max-range: 16.0

  # Minimum range for guaranteed detection (in blocks)
  # Within this range: 100% detection chance
  min-range: 2.0

  # How smooth is the transition between min and max? (0.0 - 2.0)
  # 0.5 = linear falloff
  # 1.0 = moderate falloff (recommended)
  # 1.5 = strong falloff (barely noticeable until far out)
  # 2.0 = very strong falloff (almost full volume everywhere)
  falloff-curve: 1.0

# ----------------------------------------
# Mob Hearing Mechanics
# ----------------------------------------
mob-hearing:
  enabled: true

  # ---- Hostile Mobs (Attack on detection) ----
  hostile-mobs:
    enabled: true
    # Volume threshold in decibels (dB)
    # Only audio above this level will be detected by hostile mobs
    # Range: -127 (silence) to 0 (maximum)
    # Recommended: -40 (normal speaking)
    volume-threshold-db: -40.0
    # Optional: Override for this category
    max-range: null  # null = uses detection.max-range
    min-range: null  # null = uses detection.min-range
    falloff-curve: null  # null = uses detection.falloff-curve
    # Blacklist: These mobs will NOT hear
    blacklist:
      - "PHANTOM"
      - "VEX"

  # ---- Neutral Mobs (Normally peaceful) ----
  neutral-mobs:
    enabled: true
    look-at-player: true  # Look at the player
    # Volume threshold for neutral mobs
    # Recommended: -35 (slightly more sensitive than hostile)
    volume-threshold-db: -35.0
    max-range: null
    min-range: null
    falloff-curve: null
    blacklist:
      - "ENDERMAN"

  # ---- Passive/Peaceful Mobs (Never aggressive) ----
  peaceful-mobs:
    enabled: true
    look-at-player: true
    # Volume threshold for peaceful mobs
    # Recommended: -30 (more sensitive, easily scared)
    volume-threshold-db: -30.0
    max-range: 8.0  # Shorter range for peaceful mobs
    min-range: 1.5
    falloff-curve: 1.2
    # Natural behavior settings
    natural-behavior:
      # Not all mobs react every time (more realistic)
      # Chance that a mob will react to voice (0.0 - 1.0)
      reaction-chance: 0.7  # 70% chance to react
      # How long mob looks at player after reacting (seconds)
      look-duration: 10  # 10 seconds
      # Cooldown between reactions (seconds)
      reaction-cooldown: 3  # 3 seconds
    # Flee when frightened by loud noise
    flee-behavior:
      enabled: true
      # Volume threshold for fleeing (louder than normal)
      # Recommended: -20 (loud speaking/shouting)
      flee-volume-db: -20.0
      # Maximum distance to flee from player (blocks)
      flee-distance: 3.0
      # Duration of flee behavior (seconds)
      flee-duration: 3  # 3 seconds
    # Sneaking + Talking = Mobs follow
    follow-when-sneaking:
      enabled: true
      # Must look at mob first before it follows
      require-eye-contact: true
      # Eye contact detection range (blocks)
      eye-contact-range: 4.0
      # How long mob remembers eye contact (seconds)
      eye-contact-memory: 5  # 5 seconds
      # How long mob follows (seconds)
      duration: 60  # 60 seconds
      # Max follow distance (blocks)
      max-distance: 12.0
    blacklist: []

  # ---- Warden (Special behavior) ----
  warden:
    enabled: true
    # Volume threshold for Warden
    # Recommended: -50 (very sensitive, hears everything)
    volume-threshold-db: -20.0
    max-range: 24.0  # Warden hears further
    min-range: 3.0
    falloff-curve: 0.8  # Warden hears well even far away
    # Anger scales with distance and volume:
    # Close + Loud: 50-60 Anger
    # Medium + Normal: 30-50 Anger
    # Far + Quiet: 15-30 Anger

# ----------------------------------------
# Sculk Sensor Detection
# ----------------------------------------
sculk-hearing:
  enabled: true
  # Volume threshold for Sculk Sensors
  # Recommended: -45 (sensitive, like vanilla sculk)
  volume-threshold-db: -20.0
  max-range: 16.0  # Standard Sculk Sensor Range
  min-range: 2.0
  falloff-curve: 0.9  # Sculk Sensors are more sensitive
  # Cooldown between activations (ms)
  cooldown: 1000

# ----------------------------------------
# Debug Options
# ----------------------------------------
debug:
  # Shows audio level calculations (dB, normalized, category)
  audio-logging: false
  # Shows range calculations
  range-logging: false
  # Shows mob reactions
  detection-logging: false
  # Shows Warden anger
  warden-logging: false
  # Shows Sculk activations
  sculk-logging: false
  # Shows Peaceful Mob reactions
  peaceful-logging: false

# ----------------------------------------
# Explanation: Hybrid Detection System
# ----------------------------------------
#
# HOW IT WORKS:
# 1. Player speaks → Voice Packet is captured
# 2. Opus audio is decoded to PCM samples
# 3. Audio level is calculated in decibels (dB)
# 4. If dB > volume-threshold-db → Event is fired
# 5. Entities within max-range check detection probability
# 6. Detection chance based on distance and falloff-curve
#
# DECIBEL (dB) SCALE:
# -127 dB: Complete silence
# -100 dB: Extremely quiet (background noise)
# -60 dB: Quiet speaking/whisper
# -40 dB: Normal speaking (default threshold)
# -20 dB: Loud speaking
# 0 dB: Maximum volume (shouting)
#
# VOLUME THRESHOLD EXAMPLES:
# volume-threshold-db: -60
#   → Very sensitive, detects whispers
#   → Good for stealth servers
#
# volume-threshold-db: -40 (default)
#   → Balanced, normal speaking required
#   → Recommended for most servers
#
# volume-threshold-db: -20
#   → Less sensitive, only loud speaking
#   → Good for action-focused servers
#
# RANGE SYSTEM:
# After volume check, distance-based detection:
# - 0-2 blocks (min-range): 100% detection chance
# - 2-16 blocks: Smooth falloff based on falloff-curve
# - 16+ blocks (max-range): 0% detection chance
#
# EXAMPLE (default settings):
# Player speaks at -35 dB (normal volume):
# - Passes threshold (-35 > -40) ✓
# - At 4 blocks: ~90% chance
# - At 8 blocks: ~60% chance
# - At 12 blocks: ~30% chance
# - At 16 blocks: ~10% chance
#
# Player whispers at -50 dB:
# - Fails threshold (-50 < -40) ✗
# - No detection at any distance

# ----------------------------------------
# Tuning Guide
# ----------------------------------------
#
# For STEALTH gameplay (hard to detect):
# - Increase min-range (e.g., 4.0)
# - Decrease max-range (e.g., 12.0)
# - Lower falloff-curve (e.g., 0.7)
#
# For ACTION gameplay (easy to detect):
# - Decrease min-range (e.g., 1.0)
# - Increase max-range (e.g., 20.0)
# - Higher falloff-curve (e.g., 1.5)
#
# For REALISTIC gameplay (balanced):
# - Keep defaults
# - Adjust per mob category as needed
#
# EXAMPLES:
#
# Warden ultra sensitive:
#   warden.max-range: 32.0
#   warden.falloff-curve: 0.5
#
# Peaceful mobs very shy:
#   peaceful-mobs.max-range: 6.0
#   peaceful-mobs.min-range: 1.0
#
# Sculk sensors short range:
#   sculk-hearing.max-range: 10.0
#   sculk-hearing.falloff-curve: 1.5